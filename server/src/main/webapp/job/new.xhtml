<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:c="http://java.sun.com/jsf/composite/component"
  template="/WEB-INF/includes/template.xhtml">

  <ui:define name="content">
    <div class="l__wrapper">
      <div class="g--centered">
        <div class="g__item w--1-2-m w--3-8-l w--1-2">
          <p class="txt--meta l--push-all-0">
            <a href="/home.html">#{msg['jsf.home']}</a>
          </p>
          <h1 class="l--push-all-0">#{msg['jsf.newJob']}</h1>

          <h:form id="jobForm" styleClass="l--push-top-1">
            <div class="g__item">
              <c:textfield componentId="name" value="#{newJobAction.form.name}"
                styleClass="form__item"
                label="#{msg['jsf.newJob.name']}" maxlength="100"
                hasError="#{newJobAction.hasError('name')}"
                errorMessage="#{newJobAction.getErrorMessage('name')}"/>

              <c:textarea componentId="description" value="#{newJobAction.form.description}"
                styleClass="form__item"
                label="#{msg['jsf.newJob.description']}"
                hasError="#{newJobAction.hasError('description')}"
                errorMessage="#{newJobAction.getErrorMessage('description')}"/>

              <div class="l--push-top-1">
                <h2 class="heading--secondary">
                  #{msg['jsf.newJob.syncToServer.settings']}
                </h2>
                <c:textfield componentId="syncToServerCron" value="#{newJobAction.form.syncToServerCron}"
                  label="#{msg['jsf.newJob.cron.label']}"
                  placeholder="#{msg['jsf.newJob.cron.placeholder']}"
                  hasError="#{newJobAction.hasError('syncToServerCron')}"
                  errorMessage="#{newJobAction.getErrorMessage('syncToServerCron')}"
                  styleClass="form__item"/>
                <div class="form__item">
                  <label>#{msg['jsf.newJob.syncType']}</label>
                  <h:selectOneMenu value="#{newJobAction.form.syncToServerOption}">
                    <f:selectItems value="#{newJobAction.syncOptions}" var="option"
                      itemLabel="#{option.label}" itemValue="#{option.key}" />
                  </h:selectOneMenu>
                </div>
              </div>

              <div class="l--push-top-1">
                <h2 class="heading--secondary">
                  #{msg['jsf.newJob.syncToRepo.settings']}
                </h2>
                <c:textfield componentId="syncToRepoCron" value="#{newJobAction.form.syncToRepoCron}"
                  label="#{msg['jsf.newJob.cron.label']}"
                  placeholder="#{msg['jsf.newJob.cron.placeholder']}"
                  hasError="#{newJobAction.hasError('syncToRepoCron')}"
                  errorMessage="#{newJobAction.getErrorMessage('syncToRepoCron')}"
                  styleClass="form__item"/>
                <div class="form__item">
                  <label>#{msg['jsf.newJob.syncType']}</label>
                  <h:selectOneMenu value="#{newJobAction.form.syncToRepoOption}">
                    <f:selectItems value="#{newJobAction.syncOptions}" var="option"
                      itemLabel="#{option.label}" itemValue="#{option.key}" />
                  </h:selectOneMenu>
                </div>
              </div>

              <div class="l--push-top-1">
                <h2 class="heading--secondary">
                  #{msg['jsf.newJob.sourceRepoSettings']}
                </h2>

                <h:selectOneMenu value="#{newJobAction.form.srcRepoPluginName}">
                  <f:selectItems value="#{newJobAction.repoExecutors}" var="plugin"
                    itemLabel="#{plugin.getName()}" itemValue="#{plugin.getClass().getName()}" />
                  <a4j:ajax event="change" render="selectedSrcPlugin"/>
                </h:selectOneMenu>

                <h:panelGroup layout="block" id="selectedSrcPlugin">
                  <ui:fragment rendered="#{newJobAction.selectedSrcPlugin ne null}">
                    <div class="txt--meta l--push-v-quarter">#{newJobAction.selectedSrcPlugin.getDescription()}</div>
                    <hr class="l--push-top-quarter"/>
                    <div class="form__item">
                      <ui:repeat value="#{newJobAction.selectedSrcPluginFields}" var="srcRepoField">
                        <ui:param name="key" value="#{newJobAction.form.getRepoSettingsPrefix()}#{srcRepoField.key}"/>
                        <c:textfield componentId="#{key}"
                          label="#{srcRepoField.label}" value="#{newJobAction.form.srcRepoConfig[srcRepoField.key]}"
                          styleClass="form__item" tooltip="#{srcRepoField.tooltip}"
                          placeholder="#{srcRepoField.placeholder}"
                          hasError="#{newJobAction.hasError(key)}"
                          errorMessage="#{newJobAction.getErrorMessage(key)}">
                        </c:textfield>
                      </ui:repeat>
                    </div>
                  </ui:fragment>
                </h:panelGroup>
              </div>

              <div class="l--push-top-1">
                <h2 class="heading--secondary l--push-top-half">
                  #{msg['jsf.newJob.transServer.settings']}
                </h2>

                <h:selectOneMenu value="#{newJobAction.form.transServerPluginName}">
                  <f:selectItems value="#{newJobAction.transServerExecutors}" var="plugin"
                    itemLabel="#{plugin.getName()}" itemValue="#{plugin.getClass().getName()}" />
                  <a4j:ajax event="change" render="selectedServerPlugin"/>
                </h:selectOneMenu>

                <h:panelGroup layout="block" id="selectedServerPlugin">
                  <ui:fragment rendered="#{newJobAction.selectedServerPlugin ne null}">
                    <div class="txt--meta l--push-v-quarter">#{newJobAction.selectedServerPlugin.getDescription()}</div>
                    <hr class="l--push-top-quarter"/>
                    <div class="form__item">
                      <ui:repeat value="#{newJobAction.selectedServerPluginFields}" var="transPluginField">
                        <ui:param name="key" value="#{newJobAction.form.getRepoSettingsPrefix()}#{srcRepoField.key}"/>
                        <c:textfield componentId="#{key}"
                          label="#{transPluginField.label}" value="#{newJobAction.form.transServerConfig[transPluginField.key]}"
                          styleClass="form__item" tooltip="#{transPluginField.tooltip}"
                          placeholder="#{transPluginField.placeholder}"
                          hasError="#{newJobAction.hasError(key)}"
                          errorMessage="#{newJobAction.getErrorMessage(key)}">>
                        </c:textfield>
                      </ui:repeat>
                    </div>
                  </ui:fragment>
                </h:panelGroup>

                <div class="form__item l--push-top-1">
                  <h:commandButton styleClass="button button--primary button--full"
                    value="#{msg['jsf.newJob.createJob.button']}"
                    action="#{newJobAction.onSubmitNewJob()}">
                  </h:commandButton>
                </div>
              </div>
            </div>
          </h:form>
        </div>
      </div>
    </div>
  </ui:define>
</ui:composition>